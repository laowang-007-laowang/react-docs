<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>useEffect - React ä¸­æ–‡æ–‡æ¡£</title>
  <meta name="description" content="ä»å…¥é—¨åˆ°ç²¾é€šï¼Œå…¨é¢æŒæ¡Reactå¼€å‘æŠ€èƒ½">
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/highlight.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš›ï¸</text></svg>">
</head>
<body>
  <div class="container">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <span class="logo-icon">âš›ï¸</span>
          <div class="logo-text">
            <h1>React ä¸­æ–‡æ–‡æ¡£</h1>
            <p>ç°ä»£åŒ–çš„Reactå­¦ä¹ æŒ‡å—</p>
          </div>
        </div>
        <nav class="header-nav">
          <a href="index.html" class="nav-link">é¦–é¡µ</a>
          <a href="#" class="nav-link" onclick="toggleSidebar()">ç›®å½•</a>
          <a href="https://github.com/facebook/react" target="_blank" class="nav-link">GitHub</a>
        </nav>
      </div>
    </header>

    <div class="main-layout">
      <!-- ä¾§è¾¹æ  -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-content">
          <div class="search-box">
            <input type="text" placeholder="æœç´¢æ–‡æ¡£..." id="searchInput" onkeyup="searchDocs()">
            <span class="search-icon">ğŸ”</span>
          </div>
          <nav class="doc-nav">
            
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ“š</span>
          åŸºç¡€æ¦‚å¿µ
        </h3>
        <ul class="category-docs">
          <li><a href="01-Reactç®€ä»‹.html" class="doc-link">Reactç®€ä»‹</a></li><li><a href="02-ç¯å¢ƒæ­å»º.html" class="doc-link">ç¯å¢ƒæ­å»º</a></li><li><a href="03-JSXè¯­æ³•.html" class="doc-link">JSXè¯­æ³•</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ§©</span>
          ç»„ä»¶å¼€å‘
        </h3>
        <ul class="category-docs">
          <li><a href="04-ç»„ä»¶åŸºç¡€.html" class="doc-link">ç»„ä»¶åŸºç¡€</a></li><li><a href="05-Propsä¸State.html" class="doc-link">Propsä¸State</a></li><li><a href="06-äº‹ä»¶å¤„ç†.html" class="doc-link">äº‹ä»¶å¤„ç†</a></li><li><a href="07-æ¡ä»¶æ¸²æŸ“.html" class="doc-link">æ¡ä»¶æ¸²æŸ“</a></li><li><a href="08-åˆ—è¡¨æ¸²æŸ“.html" class="doc-link">åˆ—è¡¨æ¸²æŸ“</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ£</span>
          Hooks API
        </h3>
        <ul class="category-docs">
          <li><a href="09-Hooksæ¦‚è¿°.html" class="doc-link">Hooksæ¦‚è¿°</a></li><li><a href="10-useState.html" class="doc-link">useState</a></li><li><a href="11-useEffect.html" class="doc-link">useEffect</a></li><li><a href="12-useContext.html" class="doc-link">useContext</a></li><li><a href="13-useReducer.html" class="doc-link">useReducer</a></li><li><a href="14-useMemoå’ŒuseCallback.html" class="doc-link">useMemoå’ŒuseCallback</a></li><li><a href="15-useRef.html" class="doc-link">useRef</a></li><li><a href="16-è‡ªå®šä¹‰Hooks.html" class="doc-link">è‡ªå®šä¹‰Hooks</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ”„</span>
          ç”Ÿå‘½å‘¨æœŸ
        </h3>
        <ul class="category-docs">
          <li><a href="17-ç”Ÿå‘½å‘¨æœŸæ–¹æ³•.html" class="doc-link">ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</a></li><li><a href="18-å‰¯ä½œç”¨å¤„ç†.html" class="doc-link">å‰¯ä½œç”¨å¤„ç†</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ¨</span>
          æ ·å¼ä¸UI
        </h3>
        <ul class="category-docs">
          <li><a href="19-æ ·å¼å¤„ç†.html" class="doc-link">æ ·å¼å¤„ç†</a></li><li><a href="20-åŠ¨ç”»æ•ˆæœ.html" class="doc-link">åŠ¨ç”»æ•ˆæœ</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ—ºï¸</span>
          è·¯ç”±ç®¡ç†
        </h3>
        <ul class="category-docs">
          <li><a href="21-React-Router.html" class="doc-link">React-Router</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ“¦</span>
          çŠ¶æ€ç®¡ç†
        </h3>
        <ul class="category-docs">
          <li><a href="22-Context-API.html" class="doc-link">Context-API</a></li><li><a href="23-Reduxé›†æˆ.html" class="doc-link">Reduxé›†æˆ</a></li><li><a href="24-ZustandçŠ¶æ€ç®¡ç†.html" class="doc-link">ZustandçŠ¶æ€ç®¡ç†</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸš€</span>
          æ€§èƒ½ä¼˜åŒ–
        </h3>
        <ul class="category-docs">
          <li><a href="25-æ€§èƒ½ä¼˜åŒ–æŠ€å·§.html" class="doc-link">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</a></li><li><a href="26-ä»£ç åˆ†å‰².html" class="doc-link">ä»£ç åˆ†å‰²</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ§ª</span>
          æµ‹è¯•
        </h3>
        <ul class="category-docs">
          <li><a href="27-å•å…ƒæµ‹è¯•.html" class="doc-link">å•å…ƒæµ‹è¯•</a></li><li><a href="28-é›†æˆæµ‹è¯•.html" class="doc-link">é›†æˆæµ‹è¯•</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ—ï¸</span>
          æ„å»ºä¸éƒ¨ç½²
        </h3>
        <ul class="category-docs">
          <li><a href="29-é¡¹ç›®æ„å»º.html" class="doc-link">é¡¹ç›®æ„å»º</a></li><li><a href="30-ç”Ÿäº§éƒ¨ç½².html" class="doc-link">ç”Ÿäº§éƒ¨ç½²</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ› ï¸</span>
          å¼€å‘å·¥å…·
        </h3>
        <ul class="category-docs">
          <li><a href="31-å¼€å‘è€…å·¥å…·.html" class="doc-link">å¼€å‘è€…å·¥å…·</a></li><li><a href="32-è°ƒè¯•æŠ€å·§.html" class="doc-link">è°ƒè¯•æŠ€å·§</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ“–</span>
          APIå‚è€ƒ
        </h3>
        <ul class="category-docs">
          <li><a href="33-React-APIå®Œæ•´å‚è€ƒ.html" class="doc-link">React-APIå®Œæ•´å‚è€ƒ</a></li><li><a href="34-DOMå…ƒç´ å±æ€§.html" class="doc-link">DOMå…ƒç´ å±æ€§</a></li><li><a href="35-åˆæˆäº‹ä»¶.html" class="doc-link">åˆæˆäº‹ä»¶</a></li><li><a href="React-Hookså®Œæ•´å‚è€ƒ.html" class="doc-link">React-Hookså®Œæ•´å‚è€ƒ</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ’¡</span>
          æœ€ä½³å®è·µ
        </h3>
        <ul class="category-docs">
          <li><a href="36-ç¼–ç è§„èŒƒ.html" class="doc-link">ç¼–ç è§„èŒƒ</a></li><li><a href="37-é¡¹ç›®æ¶æ„.html" class="doc-link">é¡¹ç›®æ¶æ„</a></li><li><a href="38-å¸¸è§é—®é¢˜.html" class="doc-link">å¸¸è§é—®é¢˜</a></li>
        </ul>
      </div>
          </nav>
        </div>
      </aside>

      <!-- ä¸»å†…å®¹åŒº -->
      <main class="content">
        <article class="doc-article">
          <div class="doc-header">
            <div class="breadcrumb">
              <a href="index.html">é¦–é¡µ</a>
              <span class="separator">></span>
              <span class="current">useEffect</span>
            </div>
            <h1 class="doc-title">useEffect</h1>
            <div class="doc-meta">
              <span class="category" style="background: #4facfe">
                ğŸ£ Hooks API
              </span>
            </div>
          </div>
          
          <div class="doc-content">
            <h1>useEffect Hook è¯¦è§£</h1>
<h2>ä»€ä¹ˆæ˜¯ useEffectï¼Ÿ</h2>
<p><code>useEffect</code> æ˜¯Reactä¸­ç”¨äºå¤„ç†å‰¯ä½œç”¨çš„Hookã€‚å‰¯ä½œç”¨åŒ…æ‹¬æ•°æ®è·å–ã€è®¢é˜…ã€æ‰‹åŠ¨ä¿®æ”¹DOMã€å®šæ—¶å™¨ç­‰ã€‚å®ƒç›¸å½“äºç±»ç»„ä»¶ä¸­çš„ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> å’Œ <code>componentWillUnmount</code> çš„ç»„åˆã€‚</p>
<h2>åŸºæœ¬è¯­æ³•</h2>
<pre><code class="language-javascript">import React, { useEffect } from &#39;react&#39;;

useEffect(() =&gt; {
  // å‰¯ä½œç”¨ä»£ç 
  
  return () =&gt; {
    // æ¸…ç†ä»£ç ï¼ˆå¯é€‰ï¼‰
  };
}, [dependencies]); // ä¾èµ–æ•°ç»„ï¼ˆå¯é€‰ï¼‰
</code></pre>
<h2>åŸºç¡€ç”¨æ³•</h2>
<h3>æ— ä¾èµ–çš„Effectï¼ˆæ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œï¼‰</h3>
<pre><code class="language-javascript">function Component() {
  const [count, setCount] = useState(0);
  
  // æ¯æ¬¡æ¸²æŸ“åéƒ½ä¼šæ‰§è¡Œ
  useEffect(() =&gt; {
    console.log(&#39;ç»„ä»¶å·²æ¸²æŸ“ï¼Œcount:&#39;, count);
  });
  
  return (
    &lt;div&gt;
      &lt;p&gt;Count: {count}&lt;/p&gt;
      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;+1&lt;/button&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>ç©ºä¾èµ–æ•°ç»„ï¼ˆä»…åœ¨æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼‰</h3>
<pre><code class="language-javascript">function Component() {
  useEffect(() =&gt; {
    console.log(&#39;ç»„ä»¶æŒ‚è½½&#39;);
    
    return () =&gt; {
      console.log(&#39;ç»„ä»¶å¸è½½&#39;);
    };
  }, []); // ç©ºä¾èµ–æ•°ç»„
  
  return &lt;div&gt;Hello World&lt;/div&gt;;
}
</code></pre>
<h3>å¸¦ä¾èµ–çš„Effectï¼ˆåªåœ¨ä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œï¼‰</h3>
<pre><code class="language-javascript">function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  
  useEffect(() =&gt; {
    // åªåœ¨ userId å˜åŒ–æ—¶æ‰§è¡Œ
    fetchUser(userId).then(setUser);
  }, [userId]);
  
  return (
    &lt;div&gt;
      {user ? &lt;h1&gt;{user.name}&lt;/h1&gt; : &lt;p&gt;Loading...&lt;/p&gt;}
    &lt;/div&gt;
  );
}
</code></pre>
<h2>æ•°æ®è·å–</h2>
<h3>åŸºæœ¬æ•°æ®è·å–</h3>
<pre><code class="language-javascript">function DataFetching() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() =&gt; {
    const fetchData = async () =&gt; {
      try {
        setLoading(true);
        const response = await fetch(&#39;/api/data&#39;);
        if (!response.ok) {
          throw new Error(&#39;Network response was not ok&#39;);
        }
        const result = await response.json();
        setData(result);
      } catch (err) {
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };
    
    fetchData();
  }, []);
  
  if (loading) return &lt;div&gt;Loading...&lt;/div&gt;;
  if (error) return &lt;div&gt;Error: {error}&lt;/div&gt;;
  
  return (
    &lt;div&gt;
      &lt;h1&gt;Data:&lt;/h1&gt;
      &lt;pre&gt;{JSON.stringify(data, null, 2)}&lt;/pre&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>å¸¦å‚æ•°çš„æ•°æ®è·å–</h3>
<pre><code class="language-javascript">function UserList({ searchTerm, sortBy }) {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(false);
  
  useEffect(() =&gt; {
    let cancelled = false;
    
    const fetchUsers = async () =&gt; {
      setLoading(true);
      try {
        const response = await fetch(
          `/api/users?search=${searchTerm}&amp;sort=${sortBy}`
        );
        const userData = await response.json();
        
        // æ£€æŸ¥è¯·æ±‚æ˜¯å¦å·²è¢«å–æ¶ˆ
        if (!cancelled) {
          setUsers(userData);
        }
      } catch (error) {
        if (!cancelled) {
          console.error(&#39;Failed to fetch users:&#39;, error);
        }
      } finally {
        if (!cancelled) {
          setLoading(false);
        }
      }
    };
    
    fetchUsers();
    
    // æ¸…ç†å‡½æ•°ï¼Œå–æ¶ˆè¯·æ±‚
    return () =&gt; {
      cancelled = true;
    };
  }, [searchTerm, sortBy]);
  
  return (
    &lt;div&gt;
      {loading &amp;&amp; &lt;p&gt;Loading users...&lt;/p&gt;}
      &lt;ul&gt;
        {users.map(user =&gt; (
          &lt;li key={user.id}&gt;{user.name}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>ä½¿ç”¨ AbortController å–æ¶ˆè¯·æ±‚</h3>
<pre><code class="language-javascript">function DataWithAbort() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);
  
  useEffect(() =&gt; {
    const abortController = new AbortController();
    
    const fetchData = async () =&gt; {
      setLoading(true);
      try {
        const response = await fetch(&#39;/api/data&#39;, {
          signal: abortController.signal
        });
        const result = await response.json();
        setData(result);
      } catch (error) {
        if (error.name !== &#39;AbortError&#39;) {
          console.error(&#39;Fetch error:&#39;, error);
        }
      } finally {
        setLoading(false);
      }
    };
    
    fetchData();
    
    return () =&gt; {
      abortController.abort();
    };
  }, []);
  
  return loading ? &lt;p&gt;Loading...&lt;/p&gt; : &lt;pre&gt;{JSON.stringify(data, null, 2)}&lt;/pre&gt;;
}
</code></pre>
<h2>è®¢é˜…å’Œäº‹ä»¶ç›‘å¬</h2>
<h3>DOM äº‹ä»¶ç›‘å¬</h3>
<pre><code class="language-javascript">function WindowSize() {
  const [windowSize, setWindowSize] = useState({
    width: window.innerWidth,
    height: window.innerHeight
  });
  
  useEffect(() =&gt; {
    const handleResize = () =&gt; {
      setWindowSize({
        width: window.innerWidth,
        height: window.innerHeight
      });
    };
    
    window.addEventListener(&#39;resize&#39;, handleResize);
    
    // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    return () =&gt; {
      window.removeEventListener(&#39;resize&#39;, handleResize);
    };
  }, []);
  
  return (
    &lt;div&gt;
      &lt;p&gt;çª—å£å¤§å°: {windowSize.width} x {windowSize.height}&lt;/p&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>é”®ç›˜äº‹ä»¶ç›‘å¬</h3>
<pre><code class="language-javascript">function KeyboardHandler() {
  const [pressedKeys, setPressedKeys] = useState(new Set());
  
  useEffect(() =&gt; {
    const handleKeyDown = (event) =&gt; {
      setPressedKeys(prev =&gt; new Set([...prev, event.key]));
    };
    
    const handleKeyUp = (event) =&gt; {
      setPressedKeys(prev =&gt; {
        const newSet = new Set(prev);
        newSet.delete(event.key);
        return newSet;
      });
    };
    
    document.addEventListener(&#39;keydown&#39;, handleKeyDown);
    document.addEventListener(&#39;keyup&#39;, handleKeyUp);
    
    return () =&gt; {
      document.removeEventListener(&#39;keydown&#39;, handleKeyDown);
      document.removeEventListener(&#39;keyup&#39;, handleKeyUp);
    };
  }, []);
  
  return (
    &lt;div&gt;
      &lt;p&gt;æŒ‰ä¸‹çš„é”®: {Array.from(pressedKeys).join(&#39;, &#39;)}&lt;/p&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>WebSocket è®¢é˜…</h3>
<pre><code class="language-javascript">function ChatRoom({ roomId }) {
  const [messages, setMessages] = useState([]);
  const [connectionStatus, setConnectionStatus] = useState(&#39;Disconnected&#39;);
  
  useEffect(() =&gt; {
    const ws = new WebSocket(`ws://localhost:8080/chat/${roomId}`);
    
    ws.onopen = () =&gt; {
      setConnectionStatus(&#39;Connected&#39;);
    };
    
    ws.onmessage = (event) =&gt; {
      const message = JSON.parse(event.data);
      setMessages(prev =&gt; [...prev, message]);
    };
    
    ws.onclose = () =&gt; {
      setConnectionStatus(&#39;Disconnected&#39;);
    };
    
    ws.onerror = (error) =&gt; {
      console.error(&#39;WebSocket error:&#39;, error);
      setConnectionStatus(&#39;Error&#39;);
    };
    
    return () =&gt; {
      ws.close();
    };
  }, [roomId]);
  
  return (
    &lt;div&gt;
      &lt;p&gt;çŠ¶æ€: {connectionStatus}&lt;/p&gt;
      &lt;div&gt;
        {messages.map((msg, index) =&gt; (
          &lt;div key={index}&gt;{msg.text}&lt;/div&gt;
        ))}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h2>å®šæ—¶å™¨</h2>
<h3>setInterval å’Œ setTimeout</h3>
<pre><code class="language-javascript">function Timer() {
  const [count, setCount] = useState(0);
  const [isRunning, setIsRunning] = useState(false);
  
  useEffect(() =&gt; {
    let intervalId;
    
    if (isRunning) {
      intervalId = setInterval(() =&gt; {
        setCount(prevCount =&gt; prevCount + 1);
      }, 1000);
    }
    
    return () =&gt; {
      if (intervalId) {
        clearInterval(intervalId);
      }
    };
  }, [isRunning]);
  
  const toggle = () =&gt; {
    setIsRunning(prev =&gt; !prev);
  };
  
  const reset = () =&gt; {
    setCount(0);
    setIsRunning(false);
  };
  
  return (
    &lt;div&gt;
      &lt;h2&gt;Timer: {count}s&lt;/h2&gt;
      &lt;button onClick={toggle}&gt;
        {isRunning ? &#39;Pause&#39; : &#39;Start&#39;}
      &lt;/button&gt;
      &lt;button onClick={reset}&gt;Reset&lt;/button&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>å»¶è¿Ÿæ‰§è¡Œ</h3>
<pre><code class="language-javascript">function DelayedSearch({ searchTerm }) {
  const [results, setResults] = useState([]);
  const [isSearching, setIsSearching] = useState(false);
  
  useEffect(() =&gt; {
    if (!searchTerm) {
      setResults([]);
      return;
    }
    
    setIsSearching(true);
    
    // å»¶è¿Ÿ500msæ‰§è¡Œæœç´¢
    const timeoutId = setTimeout(async () =&gt; {
      try {
        const response = await fetch(`/api/search?q=${searchTerm}`);
        const data = await response.json();
        setResults(data);
      } catch (error) {
        console.error(&#39;Search error:&#39;, error);
      } finally {
        setIsSearching(false);
      }
    }, 500);
    
    return () =&gt; {
      clearTimeout(timeoutId);
      setIsSearching(false);
    };
  }, [searchTerm]);
  
  return (
    &lt;div&gt;
      {isSearching &amp;&amp; &lt;p&gt;Searching...&lt;/p&gt;}
      &lt;ul&gt;
        {results.map(result =&gt; (
          &lt;li key={result.id}&gt;{result.title}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h2>DOM æ“ä½œ</h2>
<h3>ç›´æ¥æ“ä½œ DOM</h3>
<pre><code class="language-javascript">function FocusInput() {
  const inputRef = useRef(null);
  
  useEffect(() =&gt; {
    // ç»„ä»¶æŒ‚è½½åè‡ªåŠ¨èšç„¦
    if (inputRef.current) {
      inputRef.current.focus();
    }
  }, []);
  
  return &lt;input ref={inputRef} placeholder=&quot;This input will be focused&quot; /&gt;;
}

function ScrollToTop() {
  useEffect(() =&gt; {
    // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
    window.scrollTo(0, 0);
  }, []);
  
  return &lt;div&gt;Content...&lt;/div&gt;;
}
</code></pre>
<h3>åŠ¨æ€ä¿®æ”¹æ–‡æ¡£æ ‡é¢˜</h3>
<pre><code class="language-javascript">function DocumentTitle({ title }) {
  useEffect(() =&gt; {
    const originalTitle = document.title;
    document.title = title;
    
    return () =&gt; {
      document.title = originalTitle;
    };
  }, [title]);
  
  return null;
}

// ä½¿ç”¨
function App() {
  const [currentPage, setCurrentPage] = useState(&#39;home&#39;);
  
  return (
    &lt;div&gt;
      &lt;DocumentTitle title={`My App - ${currentPage}`} /&gt;
      &lt;nav&gt;
        &lt;button onClick={() =&gt; setCurrentPage(&#39;home&#39;)}&gt;Home&lt;/button&gt;
        &lt;button onClick={() =&gt; setCurrentPage(&#39;about&#39;)}&gt;About&lt;/button&gt;
      &lt;/nav&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h2>ä¾èµ–æ•°ç»„è¯¦è§£</h2>
<h3>ä¾èµ–æ•°ç»„çš„é‡è¦æ€§</h3>
<pre><code class="language-javascript">function DependencyExample({ userId, filter }) {
  const [user, setUser] = useState(null);
  const [posts, setPosts] = useState([]);
  
  // âŒ é”™è¯¯ï¼šç¼ºå°‘ä¾èµ–
  useEffect(() =&gt; {
    fetchUser(userId).then(setUser);
  }, []); // ç¼ºå°‘ userId ä¾èµ–
  
  // âœ… æ­£ç¡®ï¼šåŒ…å«æ‰€æœ‰ä¾èµ–
  useEffect(() =&gt; {
    fetchUser(userId).then(setUser);
  }, [userId]);
  
  // âŒ é”™è¯¯ï¼šä¾èµ–è¿‡å¤šï¼Œæ¯æ¬¡éƒ½æ‰§è¡Œ
  useEffect(() =&gt; {
    fetchPosts(userId, filter).then(setPosts);
  }, [userId, filter, posts]); // posts ä¸åº”è¯¥ä½œä¸ºä¾èµ–
  
  // âœ… æ­£ç¡®ï¼šåªåŒ…å«å¿…è¦çš„ä¾èµ–
  useEffect(() =&gt; {
    fetchPosts(userId, filter).then(setPosts);
  }, [userId, filter]);
  
  return (
    &lt;div&gt;
      &lt;h1&gt;{user?.name}&lt;/h1&gt;
      &lt;div&gt;{posts.length} posts&lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3>å¯¹è±¡å’Œå‡½æ•°ä½œä¸ºä¾èµ–</h3>
<pre><code class="language-javascript">function ObjectDependency() {
  const [user, setUser] = useState(null);
  
  // âŒ é—®é¢˜ï¼šå¯¹è±¡æ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯æ–°çš„
  const config = { timeout: 5000 };
  
  useEffect(() =&gt; {
    fetchUser(config).then(setUser);
  }, [config]); // config æ¯æ¬¡éƒ½å˜åŒ–
  
  // âœ… è§£å†³æ–¹æ¡ˆ1ï¼šå°†å¯¹è±¡ç§»åˆ°effectå†…éƒ¨
  useEffect(() =&gt; {
    const config = { timeout: 5000 };
    fetchUser(config).then(setUser);
  }, []);
  
  // âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨useMemo
  const memoizedConfig = useMemo(() =&gt; ({ timeout: 5000 }), []);
  
  useEffect(() =&gt; {
    fetchUser(memoizedConfig).then(setUser);
  }, [memoizedConfig]);
  
  return &lt;div&gt;{user?.name}&lt;/div&gt;;
}
</code></pre>
<h3>å‡½æ•°ä¾èµ–çš„å¤„ç†</h3>
<pre><code class="language-javascript">function FunctionDependency({ userId }) {
  const [user, setUser] = useState(null);
  
  // âŒ é—®é¢˜ï¼šå‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯æ–°çš„
  const fetchUserData = () =&gt; {
    return fetch(`/api/users/${userId}`);
  };
  
  useEffect(() =&gt; {
    fetchUserData().then(response =&gt; response.json()).then(setUser);
  }, [fetchUserData]); // fetchUserData æ¯æ¬¡éƒ½å˜åŒ–
  
  // âœ… è§£å†³æ–¹æ¡ˆ1ï¼šå°†å‡½æ•°ç§»åˆ°effectå†…éƒ¨
  useEffect(() =&gt; {
    const fetchUserData = () =&gt; {
      return fetch(`/api/users/${userId}`);
    };
    
    fetchUserData().then(response =&gt; response.json()).then(setUser);
  }, [userId]);
  
  // âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨useCallback
  const memoizedFetchUserData = useCallback(() =&gt; {
    return fetch(`/api/users/${userId}`);
  }, [userId]);
  
  useEffect(() =&gt; {
    memoizedFetchUserData().then(response =&gt; response.json()).then(setUser);
  }, [memoizedFetchUserData]);
  
  return &lt;div&gt;{user?.name}&lt;/div&gt;;
}
</code></pre>
<h2>æ¡ä»¶æ‰§è¡Œ Effect</h2>
<h3>åŸºäºçŠ¶æ€çš„æ¡ä»¶æ‰§è¡Œ</h3>
<pre><code class="language-javascript">function ConditionalEffect({ shouldFetch, userId }) {
  const [data, setData] = useState(null);
  
  useEffect(() =&gt; {
    if (!shouldFetch || !userId) {
      return;
    }
    
    fetchData(userId).then(setData);
  }, [shouldFetch, userId]);
  
  return data ? &lt;div&gt;{data.name}&lt;/div&gt; : &lt;div&gt;No data&lt;/div&gt;;
}
</code></pre>
<h3>è·³è¿‡ä¸å¿…è¦çš„Effect</h3>
<pre><code class="language-javascript">function SkipEffect() {
  const [count, setCount] = useState(0);
  const [name, setName] = useState(&#39;&#39;);
  
  // åªåœ¨countå˜åŒ–ä¸”å¤§äº0æ—¶æ‰§è¡Œ
  useEffect(() =&gt; {
    if (count &gt; 0) {
      console.log(`Count is now ${count}`);
    }
  }, [count]);
  
  // åªåœ¨nameä¸ä¸ºç©ºæ—¶æ‰§è¡Œ
  useEffect(() =&gt; {
    if (name.trim()) {
      document.title = `Hello, ${name}`;
    }
  }, [name]);
  
  return (
    &lt;div&gt;
      &lt;button onClick={() =&gt; setCount(c =&gt; c + 1)}&gt;
        Count: {count}
      &lt;/button&gt;
      &lt;input 
        value={name}
        onChange={e =&gt; setName(e.target.value)}
        placeholder=&quot;Enter name&quot;
      /&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h2>å¤šä¸ª Effect çš„ç»„ç»‡</h2>
<h3>æŒ‰å…³æ³¨ç‚¹åˆ†ç¦»Effect</h3>
<pre><code class="language-javascript">function MultipleEffects({ userId }) {
  const [user, setUser] = useState(null);
  const [posts, setPosts] = useState([]);
  const [onlineStatus, setOnlineStatus] = useState(false);
  
  // Effect 1: è·å–ç”¨æˆ·æ•°æ®
  useEffect(() =&gt; {
    if (userId) {
      fetchUser(userId).then(setUser);
    }
  }, [userId]);
  
  // Effect 2: è·å–ç”¨æˆ·çš„å¸–å­
  useEffect(() =&gt; {
    if (userId) {
      fetchUserPosts(userId).then(setPosts);
    }
  }, [userId]);
  
  // Effect 3: ç›‘å¬åœ¨çº¿çŠ¶æ€
  useEffect(() =&gt; {
    const handleOnline = () =&gt; setOnlineStatus(true);
    const handleOffline = () =&gt; setOnlineStatus(false);
    
    window.addEventListener(&#39;online&#39;, handleOnline);
    window.addEventListener(&#39;offline&#39;, handleOffline);
    
    return () =&gt; {
      window.removeEventListener(&#39;online&#39;, handleOnline);
      window.removeEventListener(&#39;offline&#39;, handleOffline);
    };
  }, []);
  
  // Effect 4: æ›´æ–°æ–‡æ¡£æ ‡é¢˜
  useEffect(() =&gt; {
    if (user) {
      document.title = `${user.name}&#39;s Profile`;
    }
    
    return () =&gt; {
      document.title = &#39;My App&#39;;
    };
  }, [user]);
  
  return (
    &lt;div&gt;
      &lt;h1&gt;{user?.name} {onlineStatus ? &#39;ğŸŸ¢&#39; : &#39;ğŸ”´&#39;}&lt;/h1&gt;
      &lt;div&gt;{posts.length} posts&lt;/div&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h2>è‡ªå®šä¹‰Hookä¸­çš„useEffect</h2>
<h3>å°è£…å‰¯ä½œç”¨é€»è¾‘</h3>
<pre><code class="language-javascript">// è‡ªå®šä¹‰Hook: æ•°æ®è·å–
function useApi(url) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() =&gt; {
    let cancelled = false;
    
    const fetchData = async () =&gt; {
      try {
        setLoading(true);
        setError(null);
        
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (!cancelled) {
          setData(result);
        }
      } catch (err) {
        if (!cancelled) {
          setError(err.message);
        }
      } finally {
        if (!cancelled) {
          setLoading(false);
        }
      }
    };
    
    fetchData();
    
    return () =&gt; {
      cancelled = true;
    };
  }, [url]);
  
  return { data, loading, error };
}

// ä½¿ç”¨è‡ªå®šä¹‰Hook
function UserProfile({ userId }) {
  const { data: user, loading, error } = useApi(`/api/users/${userId}`);
  
  if (loading) return &lt;div&gt;Loading...&lt;/div&gt;;
  if (error) return &lt;div&gt;Error: {error}&lt;/div&gt;;
  
  return &lt;div&gt;Welcome, {user.name}!&lt;/div&gt;;
}
</code></pre>
<h3>å°è£…äº‹ä»¶ç›‘å¬</h3>
<pre><code class="language-javascript">function useEventListener(eventName, handler, element = window) {
  useEffect(() =&gt; {
    const isSupported = element &amp;&amp; element.addEventListener;
    if (!isSupported) return;
    
    element.addEventListener(eventName, handler);
    
    return () =&gt; {
      element.removeEventListener(eventName, handler);
    };
  }, [eventName, handler, element]);
}

// ä½¿ç”¨ç¤ºä¾‹
function MouseTracker() {
  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });
  
  useEventListener(&#39;mousemove&#39;, (e) =&gt; {
    setMousePosition({ x: e.clientX, y: e.clientY });
  });
  
  return (
    &lt;div&gt;
      Mouse position: {mousePosition.x}, {mousePosition.y}
    &lt;/div&gt;
  );
}
</code></pre>
<h2>æ€§èƒ½ä¼˜åŒ–</h2>
<h3>é¿å…ä¸å¿…è¦çš„Effectæ‰§è¡Œ</h3>
<pre><code class="language-javascript">function OptimizedComponent({ user, settings }) {
  const [profile, setProfile] = useState(null);
  
  // âŒ ä¸å¥½ï¼šæ•´ä¸ªå¯¹è±¡ä½œä¸ºä¾èµ–
  useEffect(() =&gt; {
    updateProfile(user, settings);
  }, [user, settings]);
  
  // âœ… æ›´å¥½ï¼šåªä¾èµ–å®é™…ä½¿ç”¨çš„å±æ€§
  useEffect(() =&gt; {
    updateProfile(user.id, settings.theme);
  }, [user.id, settings.theme]);
  
  return &lt;div&gt;{profile?.name}&lt;/div&gt;;
}
</code></pre>
<h3>ä½¿ç”¨useCallbackä¼˜åŒ–Effectä¾èµ–</h3>
<pre><code class="language-javascript">function OptimizedWithCallback({ onDataChange }) {
  const [data, setData] = useState([]);
  
  // ä½¿ç”¨useCallbackç¨³å®šå‡½æ•°å¼•ç”¨
  const handleDataUpdate = useCallback((newData) =&gt; {
    setData(newData);
    onDataChange?.(newData);
  }, [onDataChange]);
  
  useEffect(() =&gt; {
    const subscription = subscribeToData(handleDataUpdate);
    
    return () =&gt; {
      subscription.unsubscribe();
    };
  }, [handleDataUpdate]);
  
  return &lt;div&gt;Data count: {data.length}&lt;/div&gt;;
}
</code></pre>
<h2>å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ</h2>
<h3>é”™è¯¯1ï¼šæ— é™å¾ªç¯</h3>
<pre><code class="language-javascript">// âŒ é”™è¯¯ï¼šä¼šå¯¼è‡´æ— é™å¾ªç¯
function InfiniteLoop() {
  const [data, setData] = useState([]);
  
  useEffect(() =&gt; {
    setData([...data, &#39;new item&#39;]); // data å˜åŒ– -&gt; effect æ‰§è¡Œ -&gt; data å˜åŒ– -&gt; ...
  }, [data]);
  
  return &lt;div&gt;{data.length}&lt;/div&gt;;
}

// âœ… è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°
function FixedLoop() {
  const [data, setData] = useState([]);
  
  useEffect(() =&gt; {
    const timer = setInterval(() =&gt; {
      setData(prevData =&gt; [...prevData, &#39;new item&#39;]);
    }, 1000);
    
    return () =&gt; clearInterval(timer);
  }, []); // ç©ºä¾èµ–æ•°ç»„
  
  return &lt;div&gt;{data.length}&lt;/div&gt;;
}
</code></pre>
<h3>é”™è¯¯2ï¼šå¿˜è®°æ¸…ç†</h3>
<pre><code class="language-javascript">// âŒ é”™è¯¯ï¼šå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼
function MemoryLeak() {
  const [count, setCount] = useState(0);
  
  useEffect(() =&gt; {
    const interval = setInterval(() =&gt; {
      setCount(c =&gt; c + 1);
    }, 1000);
    
    // å¿˜è®°æ¸…ç†å®šæ—¶å™¨
  }, []);
  
  return &lt;div&gt;{count}&lt;/div&gt;;
}

// âœ… æ­£ç¡®ï¼šæ¸…ç†å‰¯ä½œç”¨
function ProperCleanup() {
  const [count, setCount] = useState(0);
  
  useEffect(() =&gt; {
    const interval = setInterval(() =&gt; {
      setCount(c =&gt; c + 1);
    }, 1000);
    
    return () =&gt; clearInterval(interval);
  }, []);
  
  return &lt;div&gt;{count}&lt;/div&gt;;
}
</code></pre>
<h2>æœ€ä½³å®è·µ</h2>
<ol>
<li><strong>æ˜ç¡®ä¾èµ–å…³ç³»</strong>ï¼šç¡®ä¿ä¾èµ–æ•°ç»„åŒ…å«æ‰€æœ‰ä½¿ç”¨çš„å˜é‡</li>
<li><strong>åŠæ—¶æ¸…ç†å‰¯ä½œç”¨</strong>ï¼šé˜²æ­¢å†…å­˜æ³„æ¼å’Œæ„å¤–è¡Œä¸º</li>
<li><strong>æŒ‰å…³æ³¨ç‚¹åˆ†ç¦»</strong>ï¼šå°†ä¸ç›¸å…³çš„å‰¯ä½œç”¨åˆ†åˆ°ä¸åŒçš„useEffectä¸­</li>
<li><strong>ä¼˜åŒ–æ€§èƒ½</strong>ï¼šé¿å…ä¸å¿…è¦çš„Effectæ‰§è¡Œ</li>
<li><strong>å¤„ç†ç«æ€æ¡ä»¶</strong>ï¼šå¯¹äºå¼‚æ­¥æ“ä½œï¼Œæ­£ç¡®å¤„ç†ç»„ä»¶å¸è½½æƒ…å†µ</li>
<li><strong>ä½¿ç”¨è‡ªå®šä¹‰Hook</strong>ï¼šå°è£…å¯å¤ç”¨çš„å‰¯ä½œç”¨é€»è¾‘</li>
</ol>
<h2>ä¸‹ä¸€æ­¥</h2>
<p>å­¦ä¹ å®ŒuseEffectåï¼Œå»ºè®®ç»§ç»­å­¦ä¹ ï¼š</p>
<ol>
<li><a href="./12-useContext.md">useContext</a> - è·¨ç»„ä»¶æ•°æ®å…±äº«</li>
<li><a href="./14-useMemo%E5%92%8CuseCallback.md">useMemoå’ŒuseCallback</a> - æ€§èƒ½ä¼˜åŒ–</li>
<li><a href="./16-%E8%87%AA%E5%AE%9A%E4%B9%89Hooks.md">è‡ªå®šä¹‰Hooks</a> - å°è£…å¤æ‚é€»è¾‘</li>
</ol>

          </div>

          <!-- æ–‡æ¡£å¯¼èˆª -->
          <div class="doc-navigation">
            
              <a href="10-useState.html" class="nav-btn prev-btn">
                <span class="nav-icon">â†</span>
                <div class="nav-text">
                  <span class="nav-label">ä¸Šä¸€ç¯‡</span>
                  <span class="nav-title">useState</span>
                </div>
              </a>
            
            
            
              <a href="12-useContext.html" class="nav-btn next-btn">
                <div class="nav-text">
                  <span class="nav-label">ä¸‹ä¸€ç¯‡</span>
                  <span class="nav-title">useContext</span>
                </div>
                <span class="nav-icon">â†’</span>
              </a>
            
          </div>
        </article>
      </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="backToTop" onclick="scrollToTop()">
      <span>â†‘</span>
    </button>

    <!-- åº•éƒ¨ -->
    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2024 React ä¸­æ–‡æ–‡æ¡£. åŸºäº React 18.x æ„å»º</p>
        <p>Made with â¤ï¸ by Reactä¸­æ–‡ç¤¾åŒº</p>
      </div>
    </footer>
  </div>

  <script src="assets/script.js"></script>
</body>
</html>