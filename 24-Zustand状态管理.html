<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZustandçŠ¶æ€ç®¡ç† - React ä¸­æ–‡æ–‡æ¡£</title>
  <meta name="description" content="ä»å…¥é—¨åˆ°ç²¾é€šï¼Œå…¨é¢æŒæ¡Reactå¼€å‘æŠ€èƒ½">
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/highlight.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš›ï¸</text></svg>">
</head>
<body>
  <div class="container">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <span class="logo-icon">âš›ï¸</span>
          <div class="logo-text">
            <h1>React ä¸­æ–‡æ–‡æ¡£</h1>
            <p>ç°ä»£åŒ–çš„Reactå­¦ä¹ æŒ‡å—</p>
          </div>
        </div>
        <nav class="header-nav">
          <a href="index.html" class="nav-link">é¦–é¡µ</a>
          <a href="#" class="nav-link" onclick="toggleSidebar()">ç›®å½•</a>
          <a href="https://github.com/facebook/react" target="_blank" class="nav-link">GitHub</a>
        </nav>
      </div>
    </header>

    <div class="main-layout">
      <!-- ä¾§è¾¹æ  -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-content">
          <div class="search-box">
            <input type="text" placeholder="æœç´¢æ–‡æ¡£..." id="searchInput" onkeyup="searchDocs()">
            <span class="search-icon">ğŸ”</span>
          </div>
          <nav class="doc-nav">
            
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ“š</span>
          åŸºç¡€æ¦‚å¿µ
        </h3>
        <ul class="category-docs">
          <li><a href="01-Reactç®€ä»‹.html" class="doc-link">Reactç®€ä»‹</a></li><li><a href="02-ç¯å¢ƒæ­å»º.html" class="doc-link">ç¯å¢ƒæ­å»º</a></li><li><a href="03-JSXè¯­æ³•.html" class="doc-link">JSXè¯­æ³•</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ§©</span>
          ç»„ä»¶å¼€å‘
        </h3>
        <ul class="category-docs">
          <li><a href="04-ç»„ä»¶åŸºç¡€.html" class="doc-link">ç»„ä»¶åŸºç¡€</a></li><li><a href="05-Propsä¸State.html" class="doc-link">Propsä¸State</a></li><li><a href="06-äº‹ä»¶å¤„ç†.html" class="doc-link">äº‹ä»¶å¤„ç†</a></li><li><a href="07-æ¡ä»¶æ¸²æŸ“.html" class="doc-link">æ¡ä»¶æ¸²æŸ“</a></li><li><a href="08-åˆ—è¡¨æ¸²æŸ“.html" class="doc-link">åˆ—è¡¨æ¸²æŸ“</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ£</span>
          Hooks API
        </h3>
        <ul class="category-docs">
          <li><a href="09-Hooksæ¦‚è¿°.html" class="doc-link">Hooksæ¦‚è¿°</a></li><li><a href="10-useState.html" class="doc-link">useState</a></li><li><a href="11-useEffect.html" class="doc-link">useEffect</a></li><li><a href="12-useContext.html" class="doc-link">useContext</a></li><li><a href="13-useReducer.html" class="doc-link">useReducer</a></li><li><a href="14-useMemoå’ŒuseCallback.html" class="doc-link">useMemoå’ŒuseCallback</a></li><li><a href="15-useRef.html" class="doc-link">useRef</a></li><li><a href="16-è‡ªå®šä¹‰Hooks.html" class="doc-link">è‡ªå®šä¹‰Hooks</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ”„</span>
          ç”Ÿå‘½å‘¨æœŸ
        </h3>
        <ul class="category-docs">
          <li><a href="17-ç”Ÿå‘½å‘¨æœŸæ–¹æ³•.html" class="doc-link">ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</a></li><li><a href="18-å‰¯ä½œç”¨å¤„ç†.html" class="doc-link">å‰¯ä½œç”¨å¤„ç†</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ¨</span>
          æ ·å¼ä¸UI
        </h3>
        <ul class="category-docs">
          <li><a href="19-æ ·å¼å¤„ç†.html" class="doc-link">æ ·å¼å¤„ç†</a></li><li><a href="20-åŠ¨ç”»æ•ˆæœ.html" class="doc-link">åŠ¨ç”»æ•ˆæœ</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ—ºï¸</span>
          è·¯ç”±ç®¡ç†
        </h3>
        <ul class="category-docs">
          <li><a href="21-React-Router.html" class="doc-link">React-Router</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ“¦</span>
          çŠ¶æ€ç®¡ç†
        </h3>
        <ul class="category-docs">
          <li><a href="22-Context-API.html" class="doc-link">Context-API</a></li><li><a href="23-Reduxé›†æˆ.html" class="doc-link">Reduxé›†æˆ</a></li><li><a href="24-ZustandçŠ¶æ€ç®¡ç†.html" class="doc-link">ZustandçŠ¶æ€ç®¡ç†</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸš€</span>
          æ€§èƒ½ä¼˜åŒ–
        </h3>
        <ul class="category-docs">
          <li><a href="25-æ€§èƒ½ä¼˜åŒ–æŠ€å·§.html" class="doc-link">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</a></li><li><a href="26-ä»£ç åˆ†å‰².html" class="doc-link">ä»£ç åˆ†å‰²</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ§ª</span>
          æµ‹è¯•
        </h3>
        <ul class="category-docs">
          <li><a href="27-å•å…ƒæµ‹è¯•.html" class="doc-link">å•å…ƒæµ‹è¯•</a></li><li><a href="28-é›†æˆæµ‹è¯•.html" class="doc-link">é›†æˆæµ‹è¯•</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ—ï¸</span>
          æ„å»ºä¸éƒ¨ç½²
        </h3>
        <ul class="category-docs">
          <li><a href="29-é¡¹ç›®æ„å»º.html" class="doc-link">é¡¹ç›®æ„å»º</a></li><li><a href="30-ç”Ÿäº§éƒ¨ç½².html" class="doc-link">ç”Ÿäº§éƒ¨ç½²</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ› ï¸</span>
          å¼€å‘å·¥å…·
        </h3>
        <ul class="category-docs">
          <li><a href="31-å¼€å‘è€…å·¥å…·.html" class="doc-link">å¼€å‘è€…å·¥å…·</a></li><li><a href="32-è°ƒè¯•æŠ€å·§.html" class="doc-link">è°ƒè¯•æŠ€å·§</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ“–</span>
          APIå‚è€ƒ
        </h3>
        <ul class="category-docs">
          <li><a href="33-React-APIå®Œæ•´å‚è€ƒ.html" class="doc-link">React-APIå®Œæ•´å‚è€ƒ</a></li><li><a href="34-DOMå…ƒç´ å±æ€§.html" class="doc-link">DOMå…ƒç´ å±æ€§</a></li><li><a href="35-åˆæˆäº‹ä»¶.html" class="doc-link">åˆæˆäº‹ä»¶</a></li><li><a href="React-Hookså®Œæ•´å‚è€ƒ.html" class="doc-link">React-Hookså®Œæ•´å‚è€ƒ</a></li>
        </ul>
      </div>
      <div class="nav-category">
        <h3 class="category-title">
          <span class="category-icon">ğŸ’¡</span>
          æœ€ä½³å®è·µ
        </h3>
        <ul class="category-docs">
          <li><a href="36-ç¼–ç è§„èŒƒ.html" class="doc-link">ç¼–ç è§„èŒƒ</a></li><li><a href="37-é¡¹ç›®æ¶æ„.html" class="doc-link">é¡¹ç›®æ¶æ„</a></li><li><a href="38-å¸¸è§é—®é¢˜.html" class="doc-link">å¸¸è§é—®é¢˜</a></li>
        </ul>
      </div>
          </nav>
        </div>
      </aside>

      <!-- ä¸»å†…å®¹åŒº -->
      <main class="content">
        <article class="doc-article">
          <div class="doc-header">
            <div class="breadcrumb">
              <a href="index.html">é¦–é¡µ</a>
              <span class="separator">></span>
              <span class="current">ZustandçŠ¶æ€ç®¡ç†</span>
            </div>
            <h1 class="doc-title">ZustandçŠ¶æ€ç®¡ç†</h1>
            <div class="doc-meta">
              <span class="category" style="background: #a8edea">
                ğŸ“¦ çŠ¶æ€ç®¡ç†
              </span>
            </div>
          </div>
          
          <div class="doc-content">
            <h1>24-ZustandçŠ¶æ€ç®¡ç†</h1>
<p>Zustandæ˜¯ä¸€ä¸ªè½»é‡çº§ã€å¿«é€Ÿä¸”å¯æ‰©å±•çš„çŠ¶æ€ç®¡ç†åº“ï¼Œä¸ºReactåº”ç”¨æä¾›äº†ç®€å•ç›´è§‚çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚å®ƒçš„APIè®¾è®¡ç®€æ´ï¼Œæ²¡æœ‰æ ·æ¿ä»£ç ï¼Œæ”¯æŒTypeScriptï¼Œå¹¶ä¸”å¯ä»¥åœ¨Reactä¹‹å¤–ä½¿ç”¨ã€‚</p>
<h2>åŸºç¡€æ¦‚å¿µ</h2>
<h3>ä»€ä¹ˆæ˜¯Zustand</h3>
<p>Zustandï¼ˆå¾·è¯­ä¸­çš„&quot;çŠ¶æ€&quot;ï¼‰æ˜¯ä¸€ä¸ªç°ä»£çš„çŠ¶æ€ç®¡ç†åº“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>è½»é‡çº§</strong> - ä»…2KBå¤§å°</li>
<li><strong>æ— æ ·æ¿ä»£ç </strong> - ç®€æ´çš„APIè®¾è®¡</li>
<li><strong>TypeScriptæ”¯æŒ</strong> - åŸç”ŸTypeScriptæ”¯æŒ</li>
<li><strong>ä¸éœ€è¦Provider</strong> - æ— éœ€åŒ…è£…ç»„ä»¶</li>
<li><strong>å¯æ‰©å±•</strong> - æ”¯æŒä¸­é—´ä»¶å’Œæ’ä»¶</li>
</ul>
<h3>å®‰è£…å’ŒåŸºç¡€ç”¨æ³•</h3>
<pre><code class="language-bash">npm install zustand
# æˆ–
yarn add zustand
</code></pre>
<pre><code class="language-jsx">import { create } from &#39;zustand&#39;

// åˆ›å»ºstore
const useCounterStore = create((set) =&gt; ({
  count: 0,
  increment: () =&gt; set((state) =&gt; ({ count: state.count + 1 })),
  decrement: () =&gt; set((state) =&gt; ({ count: state.count - 1 })),
  reset: () =&gt; set({ count: 0 })
}))

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
function Counter() {
  const { count, increment, decrement, reset } = useCounterStore()

  return (
    &lt;div&gt;
      &lt;p&gt;è®¡æ•°: {count}&lt;/p&gt;
      &lt;button onClick={increment}&gt;+1&lt;/button&gt;
      &lt;button onClick={decrement}&gt;-1&lt;/button&gt;
      &lt;button onClick={reset}&gt;é‡ç½®&lt;/button&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h2>æ ¸å¿ƒAPI</h2>
<h3>createå‡½æ•°</h3>
<p><code>create</code>å‡½æ•°ç”¨äºåˆ›å»ºstoreï¼Œæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼š</p>
<pre><code class="language-jsx">const useStore = create((set, get) =&gt; ({
  // çŠ¶æ€
  bears: 0,
  
  // åŒæ­¥actions
  increasePopulation: () =&gt; set((state) =&gt; ({ bears: state.bears + 1 })),
  removeAllBears: () =&gt; set({ bears: 0 }),
  
  // å¼‚æ­¥actions
  fetchBears: async () =&gt; {
    const response = await fetch(&#39;/api/bears&#39;)
    const bears = await response.json()
    set({ bears })
  },
  
  // ä½¿ç”¨getè·å–å½“å‰çŠ¶æ€
  getBearCount: () =&gt; get().bears
}))
</code></pre>
<h3>setå‡½æ•°</h3>
<p><code>set</code>å‡½æ•°ç”¨äºæ›´æ–°çŠ¶æ€ï¼š</p>
<pre><code class="language-jsx">const useStore = create((set) =&gt; ({
  user: null,
  
  // åˆå¹¶æ›´æ–°
  updateUser: (userData) =&gt; set((state) =&gt; ({ 
    user: { ...state.user, ...userData } 
  })),
  
  // å®Œå…¨æ›¿æ¢
  setUser: (user) =&gt; set({ user }),
  
  // æ¡ä»¶æ›´æ–°
  incrementIfPositive: () =&gt; set((state) =&gt; 
    state.count &gt; 0 ? { count: state.count + 1 } : state
  )
}))
</code></pre>
<h3>getå‡½æ•°</h3>
<p><code>get</code>å‡½æ•°ç”¨äºè·å–å½“å‰çŠ¶æ€ï¼š</p>
<pre><code class="language-jsx">const useStore = create((set, get) =&gt; ({
  items: [],
  
  addItem: (item) =&gt; {
    const currentItems = get().items
    if (!currentItems.find(i =&gt; i.id === item.id)) {
      set({ items: [...currentItems, item] })
    }
  },
  
  getItemById: (id) =&gt; {
    return get().items.find(item =&gt; item.id === id)
  }
}))
</code></pre>
<h2>é€‰æ‹©æ€§è®¢é˜…</h2>
<h3>ä½¿ç”¨é€‰æ‹©å™¨ä¼˜åŒ–æ€§èƒ½</h3>
<pre><code class="language-jsx">const useUserStore = create((set) =&gt; ({
  user: { name: &#39;Alice&#39;, age: 30, email: &#39;alice@example.com&#39; },
  updateUser: (userData) =&gt; set((state) =&gt; ({ 
    user: { ...state.user, ...userData } 
  }))
}))

// åªè®¢é˜…user.nameçš„å˜åŒ–
function UserName() {
  const name = useUserStore((state) =&gt; state.user.name)
  return &lt;h1&gt;{name}&lt;/h1&gt;
}

// åªè®¢é˜…user.emailçš„å˜åŒ–
function UserEmail() {
  const email = useUserStore((state) =&gt; state.user.email)
  return &lt;p&gt;{email}&lt;/p&gt;
}

// ä½¿ç”¨è‡ªå®šä¹‰ç›¸ç­‰å‡½æ•°
function UserInfo() {
  const user = useUserStore(
    (state) =&gt; state.user,
    (oldUser, newUser) =&gt; oldUser.name === newUser.name &amp;&amp; oldUser.age === newUser.age
  )
  
  return (
    &lt;div&gt;
      &lt;p&gt;å§“å: {user.name}&lt;/p&gt;
      &lt;p&gt;å¹´é¾„: {user.age}&lt;/p&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h2>å®æˆ˜æ¡ˆä¾‹</h2>
<h3>è´­ç‰©è½¦ç®¡ç†</h3>
<pre><code class="language-jsx">import { create } from &#39;zustand&#39;

const useCartStore = create((set, get) =&gt; ({
  items: [],
  
  // æ·»åŠ å•†å“
  addItem: (product) =&gt; set((state) =&gt; {
    const existingItem = state.items.find(item =&gt; item.id === product.id)
    
    if (existingItem) {
      return {
        items: state.items.map(item =&gt;
          item.id === product.id
            ? { ...item, quantity: item.quantity + 1 }
            : item
        )
      }
    } else {
      return {
        items: [...state.items, { ...product, quantity: 1 }]
      }
    }
  }),
  
  // ç§»é™¤å•†å“
  removeItem: (productId) =&gt; set((state) =&gt; ({
    items: state.items.filter(item =&gt; item.id !== productId)
  })),
  
  // æ›´æ–°æ•°é‡
  updateQuantity: (productId, quantity) =&gt; set((state) =&gt; {
    if (quantity &lt;= 0) {
      return { items: state.items.filter(item =&gt; item.id !== productId) }
    }
    
    return {
      items: state.items.map(item =&gt;
        item.id === productId ? { ...item, quantity } : item
      )
    }
  }),
  
  // æ¸…ç©ºè´­ç‰©è½¦
  clearCart: () =&gt; set({ items: [] }),
  
  // è®¡ç®—æ€»æ•°é‡
  getTotalItems: () =&gt; {
    return get().items.reduce((sum, item) =&gt; sum + item.quantity, 0)
  },
  
  // è®¡ç®—æ€»ä»·æ ¼
  getTotalPrice: () =&gt; {
    return get().items.reduce((sum, item) =&gt; sum + (item.price * item.quantity), 0)
  }
}))

// ä½¿ç”¨è´­ç‰©è½¦
function ProductCard({ product }) {
  const { addItem, items, updateQuantity } = useCartStore()
  const cartItem = items.find(item =&gt; item.id === product.id)
  
  return (
    &lt;div className=&quot;product-card&quot;&gt;
      &lt;h3&gt;{product.name}&lt;/h3&gt;
      &lt;p&gt;Â¥{product.price}&lt;/p&gt;
      
      {cartItem ? (
        &lt;div className=&quot;quantity-controls&quot;&gt;
          &lt;button onClick={() =&gt; updateQuantity(product.id, cartItem.quantity - 1)}&gt;
            -
          &lt;/button&gt;
          &lt;span&gt;{cartItem.quantity}&lt;/span&gt;
          &lt;button onClick={() =&gt; updateQuantity(product.id, cartItem.quantity + 1)}&gt;
            +
          &lt;/button&gt;
        &lt;/div&gt;
      ) : (
        &lt;button onClick={() =&gt; addItem(product)}&gt;
          æ·»åŠ åˆ°è´­ç‰©è½¦
        &lt;/button&gt;
      )}
    &lt;/div&gt;
  )
}

function CartSummary() {
  const { getTotalItems, getTotalPrice } = useCartStore()
  
  return (
    &lt;div className=&quot;cart-summary&quot;&gt;
      &lt;p&gt;å•†å“æ•°é‡: {getTotalItems()}&lt;/p&gt;
      &lt;p&gt;æ€»ä»·: Â¥{getTotalPrice().toFixed(2)}&lt;/p&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h3>ç”¨æˆ·è®¤è¯ç®¡ç†</h3>
<pre><code class="language-jsx">const useAuthStore = create((set, get) =&gt; ({
  user: null,
  token: null,
  isLoading: false,
  error: null,
  
  // ç™»å½•
  login: async (credentials) =&gt; {
    set({ isLoading: true, error: null })
    
    try {
      const response = await fetch(&#39;/api/login&#39;, {
        method: &#39;POST&#39;,
        headers: { &#39;Content-Type&#39;: &#39;application/json&#39; },
        body: JSON.stringify(credentials)
      })
      
      if (!response.ok) {
        throw new Error(&#39;ç™»å½•å¤±è´¥&#39;)
      }
      
      const data = await response.json()
      
      set({ 
        user: data.user, 
        token: data.token, 
        isLoading: false 
      })
      
      // ä¿å­˜tokenåˆ°localStorage
      localStorage.setItem(&#39;token&#39;, data.token)
      
    } catch (error) {
      set({ error: error.message, isLoading: false })
    }
  },
  
  // é€€å‡ºç™»å½•
  logout: () =&gt; {
    localStorage.removeItem(&#39;token&#39;)
    set({ user: null, token: null, error: null })
  },
  
  // åˆå§‹åŒ–è®¤è¯çŠ¶æ€
  initAuth: async () =&gt; {
    const token = localStorage.getItem(&#39;token&#39;)
    if (!token) return
    
    set({ isLoading: true })
    
    try {
      const response = await fetch(&#39;/api/me&#39;, {
        headers: { Authorization: `Bearer ${token}` }
      })
      
      if (response.ok) {
        const user = await response.json()
        set({ user, token, isLoading: false })
      } else {
        localStorage.removeItem(&#39;token&#39;)
        set({ isLoading: false })
      }
    } catch (error) {
      localStorage.removeItem(&#39;token&#39;)
      set({ error: error.message, isLoading: false })
    }
  },
  
  // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
  isAuthenticated: () =&gt; {
    return !!get().user
  }
}))

// ä½¿ç”¨è®¤è¯
function LoginForm() {
  const { login, isLoading, error } = useAuthStore()
  const [email, setEmail] = useState(&#39;&#39;)
  const [password, setPassword] = useState(&#39;&#39;)
  
  const handleSubmit = async (e) =&gt; {
    e.preventDefault()
    await login({ email, password })
  }
  
  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input
        type=&quot;email&quot;
        value={email}
        onChange={(e) =&gt; setEmail(e.target.value)}
        placeholder=&quot;é‚®ç®±&quot;
        required
      /&gt;
      &lt;input
        type=&quot;password&quot;
        value={password}
        onChange={(e) =&gt; setPassword(e.target.value)}
        placeholder=&quot;å¯†ç &quot;
        required
      /&gt;
      &lt;button type=&quot;submit&quot; disabled={isLoading}&gt;
        {isLoading ? &#39;ç™»å½•ä¸­...&#39; : &#39;ç™»å½•&#39;}
      &lt;/button&gt;
      {error &amp;&amp; &lt;p style={{ color: &#39;red&#39; }}&gt;{error}&lt;/p&gt;}
    &lt;/form&gt;
  )
}
</code></pre>
<h2>æŒä¹…åŒ–å­˜å‚¨</h2>
<h3>ä½¿ç”¨persistä¸­é—´ä»¶</h3>
<pre><code class="language-jsx">import { create } from &#39;zustand&#39;
import { persist } from &#39;zustand/middleware&#39;

const useSettingsStore = create(
  persist(
    (set) =&gt; ({
      theme: &#39;light&#39;,
      language: &#39;zh&#39;,
      notifications: true,
      
      setTheme: (theme) =&gt; set({ theme }),
      setLanguage: (language) =&gt; set({ language }),
      toggleNotifications: () =&gt; set((state) =&gt; ({ 
        notifications: !state.notifications 
      }))
    }),
    {
      name: &#39;app-settings&#39;, // localStorageé”®å
      // å¯é€‰ï¼šè‡ªå®šä¹‰å­˜å‚¨
      storage: {
        getItem: (name) =&gt; {
          const item = localStorage.getItem(name)
          return item ? JSON.parse(item) : null
        },
        setItem: (name, value) =&gt; {
          localStorage.setItem(name, JSON.stringify(value))
        },
        removeItem: (name) =&gt; {
          localStorage.removeItem(name)
        }
      }
    }
  )
)

// ä½¿ç”¨è®¾ç½®
function Settings() {
  const { theme, language, notifications, setTheme, setLanguage, toggleNotifications } = useSettingsStore()
  
  return (
    &lt;div&gt;
      &lt;select value={theme} onChange={(e) =&gt; setTheme(e.target.value)}&gt;
        &lt;option value=&quot;light&quot;&gt;æµ…è‰²ä¸»é¢˜&lt;/option&gt;
        &lt;option value=&quot;dark&quot;&gt;æ·±è‰²ä¸»é¢˜&lt;/option&gt;
      &lt;/select&gt;
      
      &lt;select value={language} onChange={(e) =&gt; setLanguage(e.target.value)}&gt;
        &lt;option value=&quot;zh&quot;&gt;ä¸­æ–‡&lt;/option&gt;
        &lt;option value=&quot;en&quot;&gt;English&lt;/option&gt;
      &lt;/select&gt;
      
      &lt;label&gt;
        &lt;input
          type=&quot;checkbox&quot;
          checked={notifications}
          onChange={toggleNotifications}
        /&gt;
        å¯ç”¨é€šçŸ¥
      &lt;/label&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h2>ä¸­é—´ä»¶å’Œæ’ä»¶</h2>
<h3>ä½¿ç”¨immerä¸­é—´ä»¶</h3>
<pre><code class="language-jsx">import { create } from &#39;zustand&#39;
import { immer } from &#39;zustand/middleware/immer&#39;

const useTaskStore = create(
  immer((set) =&gt; ({
    tasks: [],
    
    addTask: (task) =&gt; set((state) =&gt; {
      state.tasks.push({
        id: Date.now(),
        ...task,
        completed: false,
        createdAt: new Date().toISOString()
      })
    }),
    
    updateTask: (id, updates) =&gt; set((state) =&gt; {
      const task = state.tasks.find(t =&gt; t.id === id)
      if (task) {
        Object.assign(task, updates)
      }
    }),
    
    deleteTask: (id) =&gt; set((state) =&gt; {
      const index = state.tasks.findIndex(t =&gt; t.id === id)
      if (index !== -1) {
        state.tasks.splice(index, 1)
      }
    }),
    
    toggleTask: (id) =&gt; set((state) =&gt; {
      const task = state.tasks.find(t =&gt; t.id === id)
      if (task) {
        task.completed = !task.completed
      }
    })
  }))
)
</code></pre>
<h3>è‡ªå®šä¹‰ä¸­é—´ä»¶</h3>
<pre><code class="language-jsx">// æ—¥å¿—ä¸­é—´ä»¶
const logger = (config) =&gt; (set, get, api) =&gt;
  config(
    (...args) =&gt; {
      console.log(&#39;Previous state:&#39;, get())
      set(...args)
      console.log(&#39;New state:&#39;, get())
    },
    get,
    api
  )

// ä½¿ç”¨ä¸­é—´ä»¶
const useStore = create(
  logger((set) =&gt; ({
    count: 0,
    increment: () =&gt; set((state) =&gt; ({ count: state.count + 1 }))
  }))
)
</code></pre>
<h2>TypeScriptæ”¯æŒ</h2>
<h3>ç±»å‹å®šä¹‰</h3>
<pre><code class="language-typescript">interface CounterState {
  count: number
  increment: () =&gt; void
  decrement: () =&gt; void
  reset: () =&gt; void
}

const useCounterStore = create&lt;CounterState&gt;((set) =&gt; ({
  count: 0,
  increment: () =&gt; set((state) =&gt; ({ count: state.count + 1 })),
  decrement: () =&gt; set((state) =&gt; ({ count: state.count - 1 })),
  reset: () =&gt; set({ count: 0 })
}))

// ä½¿ç”¨é€‰æ‹©å™¨çš„ç±»å‹
const count = useCounterStore((state: CounterState) =&gt; state.count)
</code></pre>
<h3>å¤æ‚çŠ¶æ€çš„ç±»å‹</h3>
<pre><code class="language-typescript">interface User {
  id: string
  name: string
  email: string
  avatar?: string
}

interface UserStore {
  users: User[]
  currentUser: User | null
  loading: boolean
  error: string | null
  
  fetchUsers: () =&gt; Promise&lt;void&gt;
  addUser: (user: Omit&lt;User, &#39;id&#39;&gt;) =&gt; void
  updateUser: (id: string, updates: Partial&lt;User&gt;) =&gt; void
  deleteUser: (id: string) =&gt; void
  setCurrentUser: (user: User | null) =&gt; void
}

const useUserStore = create&lt;UserStore&gt;((set, get) =&gt; ({
  users: [],
  currentUser: null,
  loading: false,
  error: null,
  
  fetchUsers: async () =&gt; {
    set({ loading: true, error: null })
    try {
      const response = await fetch(&#39;/api/users&#39;)
      const users = await response.json()
      set({ users, loading: false })
    } catch (error) {
      set({ error: error.message, loading: false })
    }
  },
  
  addUser: (userData) =&gt; {
    const newUser: User = {
      id: Math.random().toString(36),
      ...userData
    }
    set((state) =&gt; ({ users: [...state.users, newUser] }))
  },
  
  updateUser: (id, updates) =&gt; {
    set((state) =&gt; ({
      users: state.users.map(user =&gt;
        user.id === id ? { ...user, ...updates } : user
      )
    }))
  },
  
  deleteUser: (id) =&gt; {
    set((state) =&gt; ({
      users: state.users.filter(user =&gt; user.id !== id)
    }))
  },
  
  setCurrentUser: (user) =&gt; {
    set({ currentUser: user })
  }
}))
</code></pre>
<h2>æ€§èƒ½ä¼˜åŒ–</h2>
<h3>é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“</h3>
<pre><code class="language-jsx">// ä¸å¥½çš„åšæ³• - ä¼šå¯¼è‡´ä¸å¿…è¦çš„é‡æ¸²æŸ“
function BadComponent() {
  const store = useStore() // è®¢é˜…æ•´ä¸ªstore
  return &lt;div&gt;{store.specificValue}&lt;/div&gt;
}

// å¥½çš„åšæ³• - åªè®¢é˜…éœ€è¦çš„éƒ¨åˆ†
function GoodComponent() {
  const specificValue = useStore((state) =&gt; state.specificValue)
  return &lt;div&gt;{specificValue}&lt;/div&gt;
}

// ä½¿ç”¨æµ…æ¯”è¾ƒ
function ShallowComponent() {
  const { name, age } = useStore(
    (state) =&gt; ({ name: state.user.name, age: state.user.age }),
    shallow
  )
  return &lt;div&gt;{name}, {age}&lt;/div&gt;
}
</code></pre>
<h3>åˆ†ç¦»é¢‘ç¹æ›´æ–°çš„çŠ¶æ€</h3>
<pre><code class="language-jsx">// å°†é¢‘ç¹æ›´æ–°çš„çŠ¶æ€åˆ†ç¦»åˆ°ç‹¬ç«‹çš„store
const useAnimationStore = create((set) =&gt; ({
  progress: 0,
  setProgress: (progress) =&gt; set({ progress })
}))

const useAppStore = create((set) =&gt; ({
  user: null,
  settings: {},
  // å…¶ä»–ä¸é¢‘ç¹æ›´æ–°çš„çŠ¶æ€
}))
</code></pre>
<h2>æœ€ä½³å®è·µ</h2>
<h3>1. Storeç»„ç»‡ç»“æ„</h3>
<pre><code class="language-jsx">// æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡store
const useUserStore = create((set, get) =&gt; ({
  // çŠ¶æ€
  users: [],
  currentUser: null,
  loading: false,
  
  // Actions
  actions: {
    fetchUsers: async () =&gt; {
      // å®ç°
    },
    addUser: (user) =&gt; {
      // å®ç°
    }
  }
}))
</code></pre>
<h3>2. é”™è¯¯å¤„ç†</h3>
<pre><code class="language-jsx">const useApiStore = create((set) =&gt; ({
  data: null,
  error: null,
  loading: false,
  
  fetchData: async () =&gt; {
    set({ loading: true, error: null })
    
    try {
      const response = await fetch(&#39;/api/data&#39;)
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`)
      }
      const data = await response.json()
      set({ data, loading: false })
    } catch (error) {
      set({ error: error.message, loading: false })
    }
  }
}))
</code></pre>
<h3>3. çŠ¶æ€é‡ç½®</h3>
<pre><code class="language-jsx">const initialState = {
  user: null,
  settings: {},
  preferences: {}
}

const useStore = create((set) =&gt; ({
  ...initialState,
  
  // é‡ç½®æ•´ä¸ªstore
  reset: () =&gt; set(initialState),
  
  // é‡ç½®ç‰¹å®šçŠ¶æ€
  resetUser: () =&gt; set({ user: null }),
}))
</code></pre>
<h2>ä¸å…¶ä»–çŠ¶æ€ç®¡ç†åº“çš„å¯¹æ¯”</h2>
<h3>Zustand vs Redux</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Zustand</th>
<th>Redux</th>
</tr>
</thead>
<tbody><tr>
<td>å­¦ä¹ æ›²çº¿</td>
<td>ç®€å•</td>
<td>å¤æ‚</td>
</tr>
<tr>
<td>æ ·æ¿ä»£ç </td>
<td>å°‘</td>
<td>å¤š</td>
</tr>
<tr>
<td>TypeScriptæ”¯æŒ</td>
<td>åŸç”Ÿæ”¯æŒ</td>
<td>éœ€è¦é¢å¤–é…ç½®</td>
</tr>
<tr>
<td>ä¸­é—´ä»¶</td>
<td>è½»é‡çº§</td>
<td>ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ</td>
</tr>
<tr>
<td>åŒ…å¤§å°</td>
<td>2KB</td>
<td>è¾ƒå¤§</td>
</tr>
</tbody></table>
<h3>Zustand vs Context API</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Zustand</th>
<th>Context API</th>
</tr>
</thead>
<tbody><tr>
<td>æ€§èƒ½</td>
<td>æ›´å¥½</td>
<td>å¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„é‡æ¸²æŸ“</td>
</tr>
<tr>
<td>é€‰æ‹©æ€§è®¢é˜…</td>
<td>æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td>æŒä¹…åŒ–</td>
<td>å†…ç½®æ”¯æŒ</td>
<td>éœ€è¦æ‰‹åŠ¨å®ç°</td>
</tr>
<tr>
<td>ä¸­é—´ä»¶</td>
<td>æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td>å­¦ä¹ æˆæœ¬</td>
<td>ä½</td>
<td>ä½</td>
</tr>
</tbody></table>
<h2>è°ƒè¯•å’Œå¼€å‘å·¥å…·</h2>
<h3>ä½¿ç”¨devtoolsä¸­é—´ä»¶</h3>
<pre><code class="language-jsx">import { devtools } from &#39;zustand/middleware&#39;

const useStore = create(
  devtools((set) =&gt; ({
    bears: 0,
    increasePopulation: () =&gt; set((state) =&gt; ({ bears: state.bears + 1 })),
    removeAllBears: () =&gt; set({ bears: 0 })
  }))
)
</code></pre>
<h3>è‡ªå®šä¹‰è°ƒè¯•</h3>
<pre><code class="language-jsx">const useDebugStore = create((set, get) =&gt; ({
  count: 0,
  increment: () =&gt; {
    const newCount = get().count + 1
    console.log(`Count updated: ${get().count} -&gt; ${newCount}`)
    set({ count: newCount })
  }
}))
</code></pre>
<h2>æ€»ç»“</h2>
<p>Zustandæ˜¯ä¸€ä¸ªä¼˜ç§€çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œé€‚åˆå„ç§è§„æ¨¡çš„Reactåº”ç”¨ã€‚å®ƒçš„ä¸»è¦ä¼˜åŠ¿åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç®€å•æ˜“ç”¨</strong> - å‡ ä¹æ²¡æœ‰å­¦ä¹ æˆæœ¬</li>
<li><strong>é«˜æ€§èƒ½</strong> - é€‰æ‹©æ€§è®¢é˜…å’Œä¼˜åŒ–çš„æ›´æ–°æœºåˆ¶</li>
<li><strong>TypeScriptå‹å¥½</strong> - åŸç”ŸTypeScriptæ”¯æŒ</li>
<li><strong>è½»é‡çº§</strong> - æœ€å°çš„åŒ…å¤§å°</li>
<li><strong>çµæ´»</strong> - æ”¯æŒä¸­é—´ä»¶å’Œè‡ªå®šä¹‰æ‰©å±•</li>
</ol>
<p>é€‰æ‹©Zustandè¿˜æ˜¯å…¶ä»–çŠ¶æ€ç®¡ç†åº“ï¼Œä¸»è¦å–å†³äºä½ çš„é¡¹ç›®éœ€æ±‚ã€å›¢é˜Ÿç»éªŒå’Œä¸ªäººåå¥½ã€‚å¯¹äºå¤§å¤šæ•°é¡¹ç›®ï¼ŒZustandéƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ </p>

          </div>

          <!-- æ–‡æ¡£å¯¼èˆª -->
          <div class="doc-navigation">
            
              <a href="23-Reduxé›†æˆ.html" class="nav-btn prev-btn">
                <span class="nav-icon">â†</span>
                <div class="nav-text">
                  <span class="nav-label">ä¸Šä¸€ç¯‡</span>
                  <span class="nav-title">Reduxé›†æˆ</span>
                </div>
              </a>
            
            
            
              <a href="25-æ€§èƒ½ä¼˜åŒ–æŠ€å·§.html" class="nav-btn next-btn">
                <div class="nav-text">
                  <span class="nav-label">ä¸‹ä¸€ç¯‡</span>
                  <span class="nav-title">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</span>
                </div>
                <span class="nav-icon">â†’</span>
              </a>
            
          </div>
        </article>
      </main>
    </div>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="backToTop" onclick="scrollToTop()">
      <span>â†‘</span>
    </button>

    <!-- åº•éƒ¨ -->
    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2024 React ä¸­æ–‡æ–‡æ¡£. åŸºäº React 18.x æ„å»º</p>
        <p>Made with â¤ï¸ by Reactä¸­æ–‡ç¤¾åŒº</p>
      </div>
    </footer>
  </div>

  <script src="assets/script.js"></script>
</body>
</html>